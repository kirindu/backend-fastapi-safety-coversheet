Ejecutamos mongosh este codigo:

use coversheet_db_staging

// Script para hashear contraseñas existentes de drivers
db.drivers.find().forEach(function(driver) {
  // Solo procesar si la contraseña NO está hasheada
  // Las contraseñas hasheadas con bcrypt empiezan con "$2b$"
  if (driver.password && !driver.password.startsWith("$2b$")) {
    print("Actualizando driver: " + driver.name);
    
    // NOTA: Este script solo marca las contraseñas para actualización
    // Deberás ejecutar el script Python a continuación
    db.drivers_to_hash.insertOne({
      driver_id: driver._id,
      username: driver.name,
      plain_password: driver.password
    });
  }
});

print("Drivers marcados para actualización de contraseña");
print("Total: " + db.drivers_to_hash.countDocuments());



// Luego corremos en la terminal del proyecto python migrate_driver_passwords.py, recuerda correr esto dentro del entorno virtual en vscode